<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>SKY - Busca tu vuelo</title>

    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;600;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    body{
        font-family:"Nunito",sans-serif;
        background:#eef4ff;
    }

    .header{
        height:85px;
        background:white;
        box-shadow:0 4px 20px rgba(0,0,0,0.08);
        position:sticky;
        top:0;
        z-index:50;
    }

    .navbar{
        max-width:1200px;
        margin:auto;
        height:100%;
        display:flex;
        align-items:center;
        justify-content:space-between;
        padding:0 1.5rem;
    }

    .logo{
        font-size:1.9rem;
        font-weight:800;
        color:#592385;
        letter-spacing:-1px;
    }

    .nav-links a{
        margin-left:25px;
        font-weight:600;
        color:#592385;
        text-decoration:none;
        transition:.2s;
    }

    .nav-links a:hover{
        color:#34115b;
    }

    .banner{
        background:linear-gradient(to right, #5c2dbf, #8338ec);
        padding:70px 0;
        text-align:center;
        color:white;
        margin-bottom:50px;
        box-shadow:0 6px 20px rgba(0,0,0,0.12);
    }
    .banner h1{
        font-size:2.9rem;
        font-weight:800;
        margin-bottom:8px;
    }
    .banner p{
        font-size:1.2rem;
        opacity:0.9;
    }

    .search-box{
        max-width:850px;
        margin:auto;
        background:white;
        padding:35px;
        border-radius:22px;
        box-shadow:0 10px 30px rgba(0,0,0,0.10);
        animation:fadeIn .3s ease-out;
    }

    @keyframes fadeIn{
        from{opacity:0; transform:translateY(10px);}
        to{opacity:1; transform:translateY(0);}
    }

    .search-title{
        text-align:center;
        font-size:2rem;
        font-weight:800;
        color:#592385;
        margin-bottom:30px;
    }

    .input-box{
        padding:15px;
        border-radius:14px;
        border:2px solid #e3e1f3;
        width:100%;
        background:white;
        cursor:pointer;
        transition:.25s;
    }

    .input-box:hover{
        border-color:#c9c3ff;
    }

    .input-box:focus{
        border-color:#8a6cd1;
        box-shadow:0 0 6px #c7b5ff;
    }

    .dropdown-container{
        position:relative;
    }

    .dropdown-list{
        position:absolute;
        top:105%;
        left:0;
        width:100%;
        background:white;
        border-radius:15px;
        box-shadow:0 12px 28px rgba(0,0,0,0.12);
        border:1px solid #efeaff;
        display:none;
        z-index:10;
        max-height:240px;
        overflow-y:auto;
        animation:fadeDown .18s ease-out;
    }

    @keyframes fadeDown{
        from{opacity:0; transform:translateY(-5px);}
        to{opacity:1; transform:translateY(0);}
    }

    .dropdown-item{
        padding:14px 18px;
        cursor:pointer;
        font-weight:600;
        transition:.2s;
    }

    .dropdown-item:hover{
        background:#f2ebff;
        color:#592385;
    }

    .btn-skairo{
        background:#592385;
        color:white;
        font-weight:800;
        padding:14px 30px;
        border-radius:14px;
        font-size:1.1rem;
        transition:.25s;
        box-shadow:0 4px 10px rgba(0,0,0,0.15);
    }

    .btn-skairo:hover{
        background:#441b6d;
        transform:translateY(-2px);
        box-shadow:0 8px 18px rgba(0,0,0,0.2);
    }
    .input-error{
    border-color: #e63946 !important;
    box-shadow: 0 0 6px rgba(230,57,70,0.5);
}

.error-text{
    color:#e63946;
    font-size:0.85rem;
    margin-top:6px;
    font-weight:600;
    display:none;
}

</style>


</head>
<body>

<!-- navbar -->
<header class="header">
    <nav class="navbar">
        <div class="logo">SKY</div>
        <div class="nav-links">
            <a href="{{ url_for('reservas') }}">Compra tu boleto</a>
            <a href="{{ url_for('estado_vuelo') }}">Estado de vuelo</a>
        </div>
    </nav>
</header>

<!-- banner -->
<section class="banner">
    <h1>Tu viaje empieza aquí</h1>
    <p>Busca, reserva y vuela con SKY Airlines</p>
</section>

<!--sección de buscar-->
<div class="search-box">
    <h2 class="search-title">Ver Disponibilidad</h2>

    <form action="/buscar_vuelos" method="POST" class="row g-4">

       <div class="col-md-6 dropdown-container">
    <label class="fw-bold mb-2">Origen</label>
    <input type="text" id="inputOrigen" class="input-box" placeholder="Seleccionar origen" readonly>
    <input type="hidden" name="origen" id="origen">
    <div id="errOrigen" class="error-text">⚠ Debes seleccionar un ORIGEN</div>
    <div class="dropdown-list" id="listaOrigen"></div>
</div>

<div class="col-md-6 dropdown-container">
    <label class="fw-bold mb-2">Destino</label>
    <input type="text" id="inputDestino" class="input-box" placeholder="Seleccionar destino" readonly>
    <input type="hidden" name="destino" id="destino">
    <div id="errDestino" class="error-text">⚠ Debes seleccionar un DESTINO</div>
    <div class="dropdown-list" id="listaDestino"></div>
</div>
        <div class="text-center">
            <button type="submit" class="btn-skairo">Buscar vuelos</button>
        </div>
    </form>
</div>
<!-- reservas -->
<div class="search-box mt-5">
    <h2 class="text-center fw-bold mb-3" style="color:#592385;">¿Ya tienes una reserva?</h2>
    <div class="text-center">
        <a href="/reservas" class="btn btn-skairo">Ir a mis reservas</a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
<script>
// cargar orignes
fetch('/api/origenes')
.then(r => r.json())
.then(data => {
    let lista = document.getElementById("listaOrigen");
    data.data.forEach(o=>{
        lista.innerHTML += `<div class="dropdown-item origen-op">${o}</div>`;
    });
});

document.getElementById("inputOrigen").onclick = ()=>{
    document.getElementById("listaOrigen").style.display="block";
};

// elegir origen
document.addEventListener("click", e => {
    if(e.target.classList.contains("origen-op")){
        let v = e.target.innerText;
        document.getElementById("inputOrigen").value = v;
        document.getElementById("origen").value = v;
        document.getElementById("listaOrigen").style.display="none";

        cargarDestinos(v);
    }
});

// ver destinos
function cargarDestinos(origen){
    fetch(`/api/destinos/${origen}`)
    .then(r=>r.json())
    .then(data=>{
        let lista = document.getElementById("listaDestino");
        lista.innerHTML = "";
        data.data.forEach(d=>{
            lista.innerHTML += `<div class="dropdown-item destino-op">${d}</div>`;
        });
        document.getElementById("inputDestino").value = "";
        document.getElementById("destino").value = "";
    });
}

document.getElementById("inputDestino").onclick = ()=>{
    document.getElementById("listaDestino").style.display="block";
};

// Pal destino
document.addEventListener("click", e => {
    if(e.target.classList.contains("destino-op")){
        let v = e.target.innerText;
        document.getElementById("inputDestino").value = v;
        document.getElementById("destino").value = v;
        document.getElementById("listaDestino").style.display="none";
    }
});

// Validación
document.querySelector("form").addEventListener("submit", function(e){

    let origen = document.getElementById("origen").value.trim();
    let destino = document.getElementById("destino").value.trim();

    let inputOrigen = document.getElementById("inputOrigen");
    let inputDestino = document.getElementById("inputDestino");

    let errOrigen = document.getElementById("errOrigen");
    let errDestino = document.getElementById("errDestino");

    let valido = true;

    if(origen === ""){
        valido = false;
        inputOrigen.classList.add("input-error");
        errOrigen.style.display = "block";
    } else {
        inputOrigen.classList.remove("input-error");
        errOrigen.style.display = "none";
    }

    if(destino === ""){
        valido = false;
        inputDestino.classList.add("input-error");
        errDestino.style.display = "block";
    } else {
        inputDestino.classList.remove("input-error");
        errDestino.style.display = "none";
    }

    if(!valido){
        e.preventDefault();
        return;
    }
});

</script>

</body>
</html>


